#!/usr/bin/make -f

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

package = libmcclibhid

clean:
	dh_clean
	rm -f build
	[ ! -f Makefile ] || $(MAKE) distclean
	rm -f *.d
	rm -f missing config.guess config.sub ltmain.sh install-sh depcomp config.h.in 
	rm -f Makefile.in aclocal.m4 config.log configure
	rm -f debian/tmp debian/substvars
	chmod a-x bootstrap.sh

install: build
	dh_clean
	dh_installdirs
	$(MAKE) prefix=$(CURDIR)/debian/$(package)/usr install
	install -d $(CURDIR)/debian/$(package)/etc/udev/rules.d
	install --mode 644 99-mcclibhid.rules $(CURDIR)/debian/$(package)/etc/udev/rules.d

build:
	chmod a+x bootstrap.sh
	rm -f Makefile
	./bootstrap.sh
	chmod a+x configure
	./configure --prefix=/usr
	$(MAKE) CC="$(CC)" CFLAGS="$(CFLAGS)"
	touch build

binary-indep: install
# There are no architecture-independent files to be uploaded
# generated by this package.  If there were any they would be
# made here.

binary-arch: install
	dh_installdocs
	dh_installchangelogs
	dh_strip -a
	dh_compress -a
	dh_fixperms -a
	dh_installdeb -a
	dh_makeshlibs
	dh_shlibdeps -L libmcclibhid -l debian/$(package)/usr/lib
	dh_gencontrol -a
	dh_md5sums -a
	dh_builddeb -a

binary: binary-indep binary-arch

.PHONY: binary binary-arch binary-indep clean
